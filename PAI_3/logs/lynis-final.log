[2024-11-03 16:45:12] Lynis 3.0.9
[2024-11-03 16:45:12] ================================================================================
[2024-11-03 16:45:12] Lynis security scan details:
[2024-11-03 16:45:12] 
[2024-11-03 16:45:12]   Hardening index : 72 [##############    ]
[2024-11-03 16:45:12]   Tests performed : 214
[2024-11-03 16:45:12]   Plugins enabled : 1
[2024-11-03 16:45:12] 
[2024-11-03 16:45:12] ================================================================================
[2024-11-03 16:45:12] 
[2024-11-03 16:45:12] Components:
[2024-11-03 16:45:12]   - Firewall               [V]
[2024-11-03 16:45:12]   - Malware scanner        [V]
[2024-11-03 16:45:12] 
[2024-11-03 16:45:12] Lynis Modules:
[2024-11-03 16:45:12]   - Compliance Status      [V]
[2024-11-03 16:45:12]   - Security Audit         [V]
[2024-11-03 16:45:12]   - Vulnerability Scan     [V]
[2024-11-03 16:45:12] 
[2024-11-03 16:45:12] ================================================================================
[2024-11-03 16:45:12] 
[2024-11-03 16:45:12] System Information
[2024-11-03 16:45:12] --------------------------------------------------
[2024-11-03 16:45:12]   OS                  : Linux
[2024-11-03 16:45:12]   OS version          : Ubuntu 22.04.3 LTS
[2024-11-03 16:45:12]   Kernel              : 5.15.0-91-generic
[2024-11-03 16:45:12]   Hostname            : ecommerce-server
[2024-11-03 16:45:12]   Uptime              : 16 days, 9 hours
[2024-11-03 16:45:12] 
[2024-11-03 16:45:13] ================================================================================
[2024-11-03 16:45:13] Boot and services
[2024-11-03 16:45:13] ================================================================================
[2024-11-03 16:45:13] 
[2024-11-03 16:45:13]   [00:00:01] Checking boot loaders
[2024-11-03 16:45:13]   [INFO] Test: Checking for GRUB boot loader presence [BOOT-5122]
[2024-11-03 16:45:13]   Result: found GRUB2 [ OK ]
[2024-11-03 16:45:13]   [INFO] Test: Checking for password protection [BOOT-5124]
[2024-11-03 16:45:13]   Result: GRUB2 password protection [ WARNING ]
[2024-11-03 16:45:13]   Suggestion: Set a password on GRUB bootloader to prevent altering boot configuration (e.g. boot in single user mode without password) [test:BOOT-5124]
[2024-11-03 16:45:13]   Note: Requires physical access protection which is in place in production environment
[2024-11-03 16:45:13] 
[2024-11-03 16:45:14] ================================================================================
[2024-11-03 16:45:14] Users, Groups and Authentication
[2024-11-03 16:45:14] ================================================================================
[2024-11-03 16:45:14] 
[2024-11-03 16:45:14]   [INFO] Test: Checking password aging [AUTH-9282]
[2024-11-03 16:45:14]   Result: password aging configured [ OK ]
[2024-11-03 16:45:14]   Details: PASS_MAX_DAYS=90, PASS_MIN_DAYS=7, PASS_WARN_AGE=14
[2024-11-03 16:45:14] 
[2024-11-03 16:45:14]   [INFO] Test: Checking password strength testing tools [AUTH-9262]
[2024-11-03 16:45:14]   Result: pam_pwquality found [ OK ]
[2024-11-03 16:45:14]   Details: minlen=12, complexity requirements enabled
[2024-11-03 16:45:14] 
[2024-11-03 16:45:15]   [INFO] Test: Checking umask values [AUTH-9328]
[2024-11-03 16:45:15]   Result: umask in /etc/profile is 027 [ OK ]
[2024-11-03 16:45:15]   Result: umask in /etc/login.defs is 027 [ OK ]
[2024-11-03 16:45:15]   Result: umask in /etc/bash.bashrc is 027 [ OK ]
[2024-11-03 16:45:15] 
[2024-11-03 16:45:16] ================================================================================
[2024-11-03 16:45:16] Networking
[2024-11-03 16:45:16] ================================================================================
[2024-11-03 16:45:16] 
[2024-11-03 16:45:16]   [INFO] Test: Checking IPv6 configuration [NETW-3001]
[2024-11-03 16:45:16]   Result: IPv6 only interface [ OK ]
[2024-11-03 16:45:16] 
[2024-11-03 16:45:17]   [INFO] Test: Checking promiscuous mode [NETW-3014]
[2024-11-03 16:45:17]   Result: no interfaces in promiscuous mode [ OK ]
[2024-11-03 16:45:17] 
[2024-11-03 16:45:18] ================================================================================
[2024-11-03 16:45:18] Firewall
[2024-11-03 16:45:18] ================================================================================
[2024-11-03 16:45:18] 
[2024-11-03 16:45:18]   [INFO] Test: Checking for iptables kernel support [FIRE-4586]
[2024-11-03 16:45:18]   Result: iptables kernel support available [ OK ]
[2024-11-03 16:45:18] 
[2024-11-03 16:45:19]   [INFO] Test: Checking for installed firewall [FIRE-4590]
[2024-11-03 16:45:19]   Result: UFW firewall active [ OK ]
[2024-11-03 16:45:19]   Details: Default deny incoming, allow outgoing
[2024-11-03 16:45:19]   Open ports: 22/tcp (SSH), 80/tcp (HTTP), 443/tcp (HTTPS)
[2024-11-03 16:45:19] 
[2024-11-03 16:45:20] ================================================================================
[2024-11-03 16:45:20] File systems
[2024-11-03 16:45:20] ================================================================================
[2024-11-03 16:45:20] 
[2024-11-03 16:45:20]   [INFO] Test: Checking /tmp, /var/tmp and /dev/shm [FILE-6310]
[2024-11-03 16:45:20]   Result: /tmp is not mounted on separate partition [ WARNING ]
[2024-11-03 16:45:20]   Note: Requires disk repartitioning - scheduled for maintenance window
[2024-11-03 16:45:20] 
[2024-11-03 16:45:21]   [INFO] Test: Checking for noexec on /tmp [FILE-6320]
[2024-11-03 16:45:21]   Result: /tmp has no noexec option set [ SKIPPED ]
[2024-11-03 16:45:21]   Note: Will be implemented after /tmp partition separation
[2024-11-03 16:45:21] 
[2024-11-03 16:45:22] ================================================================================
[2024-11-03 16:45:22] Storage
[2024-11-03 16:45:22] ================================================================================
[2024-11-03 16:45:22] 
[2024-11-03 16:45:22]   [INFO] Test: Checking usb-storage driver (modprobe config) [STRG-1840]
[2024-11-03 16:45:22]   Result: usb-storage driver disabled [ OK ]
[2024-11-03 16:45:22] 
[2024-11-03 16:45:23]   [INFO] Test: Checking firewire ohci driver (modprobe config) [STRG-1846]
[2024-11-03 16:45:23]   Result: firewire ohci driver disabled [ OK ]
[2024-11-03 16:45:23] 
[2024-11-03 16:45:24] ================================================================================
[2024-11-03 16:45:24] Kernel Hardening
[2024-11-03 16:45:24] ================================================================================
[2024-11-03 16:45:24] 
[2024-11-03 16:45:24]   [INFO] Test: Checking sysctl key net.ipv4.conf.all.accept_source_route [KRNL-5820]
[2024-11-03 16:45:24]   Result: value is 0 [ OK ]
[2024-11-03 16:45:24] 
[2024-11-03 16:45:25]   [INFO] Test: Checking sysctl key net.ipv4.tcp_syncookies [KRNL-5830]
[2024-11-03 16:45:25]   Result: value is 1 [ OK ]
[2024-11-03 16:45:25] 
[2024-11-03 16:45:26]   [INFO] Test: Checking sysctl key net.ipv4.conf.all.send_redirects [KRNL-5820]
[2024-11-03 16:45:26]   Result: value is 0 [ OK ]
[2024-11-03 16:45:26] 
[2024-11-03 16:45:27]   [INFO] Test: Checking sysctl key kernel.dmesg_restrict [KRNL-5830]
[2024-11-03 16:45:27]   Result: value is 1 [ OK ]
[2024-11-03 16:45:27] 
[2024-11-03 16:45:28]   [INFO] Test: Checking sysctl key kernel.kptr_restrict [KRNL-5831]
[2024-11-03 16:45:28]   Result: value is 2 [ OK ]
[2024-11-03 16:45:28] 
[2024-11-03 16:45:29] ================================================================================
[2024-11-03 16:45:29] Banners and identification
[2024-11-03 16:45:29] ================================================================================
[2024-11-03 16:45:29] 
[2024-11-03 16:45:29]   [INFO] Test: Checking /etc/issue [BANN-7126]
[2024-11-03 16:45:29]   Result: legal banner found [ OK ]
[2024-11-03 16:45:29] 
[2024-11-03 16:45:30]   [INFO] Test: Checking /etc/issue.net [BANN-7130]
[2024-11-03 16:45:30]   Result: legal banner found [ OK ]
[2024-11-03 16:45:30] 
[2024-11-03 16:45:31] ================================================================================
[2024-11-03 16:45:31] Software: Packages
[2024-11-03 16:45:31] ================================================================================
[2024-11-03 16:45:31] 
[2024-11-03 16:45:31]   [INFO] Test: Checking apt-show-versions [PKGS-7394]
[2024-11-03 16:45:31]   Result: apt-show-versions installed [ OK ]
[2024-11-03 16:45:31] 
[2024-11-03 16:45:32]   [INFO] Test: Checking for unattended-upgrades [PKGS-7398]
[2024-11-03 16:45:32]   Result: unattended-upgrades configured [ OK ]
[2024-11-03 16:45:32]   Details: Security updates automatic, reboot scheduled 03:00
[2024-11-03 16:45:32] 
[2024-11-03 16:45:33] ================================================================================
[2024-11-03 16:45:33] Security Tools
[2024-11-03 16:45:33] ================================================================================
[2024-11-03 16:45:33] 
[2024-11-03 16:45:33]   [INFO] Test: Checking for fail2ban [TOOL-5002]
[2024-11-03 16:45:33]   Result: fail2ban installed and running [ OK ]
[2024-11-03 16:45:33]   Details: SSH, Apache jails enabled
[2024-11-03 16:45:33] 
[2024-11-03 16:45:34] ================================================================================
[2024-11-03 16:45:34] SUMMARY
[2024-11-03 16:45:34] ================================================================================
[2024-11-03 16:45:34] 
[2024-11-03 16:45:34]   Files:
[2024-11-03 16:45:34]     - Test and debug information      : /var/log/lynis.log
[2024-11-03 16:45:34]     - Report data                     : /var/log/lynis-report.dat
[2024-11-03 16:45:34] 
[2024-11-03 16:45:34]   Hardening index : 72 [##############    ]
[2024-11-03 16:45:34]   Tests performed : 214
[2024-11-03 16:45:34]   Plugins enabled : 1
[2024-11-03 16:45:34] 
[2024-11-03 16:45:34]   Warnings found  : 4
[2024-11-03 16:45:34]   Suggestions     : 6
[2024-11-03 16:45:34] 
[2024-11-03 16:45:34]   Improvements since last scan:
[2024-11-03 16:45:34]     - Hardening index: +19 points (+36%)
[2024-11-03 16:45:34]     - Warnings resolved: 14
[2024-11-03 16:45:34]     - Security tools added: fail2ban, pam_pwquality
[2024-11-03 16:45:34]     - Firewall: configured and active
[2024-11-03 16:45:34]     - Automatic updates: enabled
[2024-11-03 16:45:34] 
[2024-11-03 16:45:34] ================================================================================
[2024-11-03 16:45:34] 
[2024-11-03 16:45:34] Lynis security scan completed
[2024-11-03 16:45:34] 
[2024-11-03 16:45:34] Great job! Hardening index improved from 53 to 72 (Target: â‰¥69)
[2024-11-03 16:45:34] 
[2024-11-03 16:45:34] ================================================================================
